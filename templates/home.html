{% extends 'base.html' %}

{% block content %}
<form id="upload-form" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <input type="file" id="file-upload" name="file">
    <button type="submit">Upload</button>
</form>
<div id="preview"></div>

    <script>
        document.getElementById('file-upload').addEventListener('change', function(e) {
            var file = e.target.files[0];
            if (file) {
                var reader = new FileReader();
                reader.onload = function(event) {
                    var data = new Uint8Array(event.target.result);
                    var workbook = XLSX.read(data, { type: 'array' });
                    var sheetName = workbook.SheetNames[0];
                    var worksheet = workbook.Sheets[sheetName];
                    var htmlTable = XLSX.utils.sheet_to_html(worksheet, {
                        dhmos: 'datatable',
                        importdate: 'datatable',
                        app: 'datatable',
                        jobtype: 'datatable',
                        info: 'datatable',
                        text: 'datatable',
                        employee: 'datatable',
                        time: 'datatable',
                        name: 'datatable',

                    });
                    document.getElementById('preview').innerHTML = htmlTable;
                };
                reader.readAsArrayBuffer(file);
            }
        });
        </script>
        

{% endblock %}